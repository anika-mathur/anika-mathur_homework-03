Homework 3

name : \[Anika Mathur\]

repository : \[[anika-mathur_homework-03](https://github.com/anika-mathur/anika-mathur_homework-03)\]

setup

```{r}
# general use
library(tidyverse)
library(readxl)
library(here)
library(janitor)

# visualizing pairs
library(GGally)

# model selection
library(MuMIn)

# model predictions
library(ggeffects)

# model tables
library(gtsummary)
library(flextable)
library(modelsummary)
library(ggplot2)
library(kableExtra)
library(broom)
library(dplyr)

drought_exp <- read_xlsx(path = here("data", 
                                     "Valliere_etal_EcoApps_Data.xlsx"),
                         sheet = "First Harvest")

# quick look at data 
str(drought_exp)
class(drought_exp)
```

cleaning

```{r}
# cleaning
drought_exp_clean <- drought_exp %>% 
  clean_names() %>% # nicer column names
  mutate(species_name = case_when( # adding column with species scientific names
    species == "ENCCAL" ~ "Encelia californica", # bush sunflower
    species == "ESCCAL" ~ "Eschscholzia californica", # California poppy
    species == "PENCEN" ~ "Penstemon centranthifolius", # Scarlet bugler
    species == "GRICAM" ~ "Grindelia camporum", # great valley gumweed
    species == "SALLEU" ~ "Salvia leucophylla", # Purple sage
    species == "STIPUL" ~ "Nasella pulchra", # Purple needlegrass
    species == "LOTSCO" ~ "Acmispon glaber" # deerweed
  )) %>% 
  relocate(species_name, .after = species) %>% # moving species_name column after species
  mutate(water_treatment = case_when( # adding column with full treatment names
    water == "WW" ~ "Well watered",
    water == "DS" ~ "Drought stressed"
  )) %>% 
  relocate(water_treatment, .after = water) # moving water_treatment column after water
```

visualizing

correlations

```{r}
ggpairs(drought_exp_clean, # data frame
        columns = c("leaf_dry_weight_g", # columns to visualize
                    "sla", 
                    "shoot_g", 
                    "root_g", 
                    "total_g"), 
        upper = list(method = "pearson")) + # calculating Pearson correlation coefficient
  theme_bw() + # cleaner theme
  theme(panel.grid = element_blank()) # getting rid of gridlines
```

biomass between species

```{r}
ggplot(data = drought_exp_clean, # data frame
       aes(x = reorder(species_name, # reordering x-axis
                       -total_g, # in reverse order of mean total mass
                       fun = mean), # calculating mean to reorder
           y = total_g)) + # y-axis
  geom_jitter(width = 0.1, # narrow jitter
              height = 0) # not jittering points up and down
```

total biomass difference between water treatments

```{r}
ggplot(data = drought_exp_clean, # data frame
       aes(x = water_treatment, # x-axis
           y = total_g)) + # y-axis
  geom_jitter(width = 0.1, # narrow jitter
              height = 0) # not jittering points up and down
```

SLA influence on biomass

```{r}
ggplot(data = drought_exp_clean, # data frame
       aes(x = sla, # x-axis
           y = total_g)) + # y-axis
  geom_point() # scatterplot
```

null model

```{r}
model0 <- lm(total_g ~ 1, # formula
             data = drought_exp_clean) # data frame
```

total biomass as a function of SLA, water treatment, and species

```{r}
# saturated model
model1 <- lm(total_g ~ sla + water_treatment + species_name,
             data = drought_exp_clean)

par(mfrow = c(2, 2))
plot(model1)
```

total biomass as a function of SLA and water treatment

```{r}
model2 <- lm(total_g ~ sla + water_treatment,
             data = drought_exp_clean)

plot(model2)
```

total biomass as a function of SLA and species

```{r}
model3 <- lm(total_g ~ sla + species_name,
             data = drought_exp_clean)

plot(model3)
```

total biomass as a function of water treatment and species

```{r}
model4 <- lm(total_g ~ water_treatment + species_name,
             data = drought_exp_clean)

plot(model4)
```

model selection

```{r}
model.sel(model0,
          model1, 
          model2, 
          model3,
          model4)
```

Problem 1

1a.

Total biomass and its predictors

| Model    | Predictors                                            |
|----------|-------------------------------------------------------|
| 0 (null) | n/a                                                   |
| 1        | SLA(specific leaf area), water treatment, and species |
| 2        | SLA and water treatment                               |
| 3        | SLA and species                                       |
| 4        | water treatment and species                           |

1b.

To examine the effects of SLA(specific leaf area), water treatment, and species on total biomass, I created models to understand the relationship between these predictors. There were already null and saturated models, as well as models with SLA + water treatment, and SLA + species. I chose water treatment and species as the predictors to create another model. To choose this model, I looked at the relationship between the predictors in previous models, and decided to use the two predictors whose individual relationship hadn’t been tested yet (water treatment and species). To evaluate linear model assumptions, I looked at the residuals vs. fitted plot and the residuals vs normal Q-Q plot. The fitted plot shows the points scattered around the horizontal line, and the qq plot has points distributed close to its diagonal line, indicating the residuals’ normality.

1c.

```{r}
# model predictions and the confidence intervals
predictions <- predict(model4, newdata = drought_exp_clean, interval = "confidence")

drought_exp_clean$predicted <- predictions[,1]
drought_exp_clean$conf.low <- predictions[,2]
drought_exp_clean$conf.high <- predictions[,3]

# make a plot
p <- ggplot(data = drought_exp_clean, aes(x = species_name, y = total_g, color = water_treatment)) +
  
  geom_point(position = position_jitter(height = 0.1), alpha = 0.5, size = 2) + 
  
  # confidence intervals and prediction lines
  geom_line(aes(y = predicted), size = 1) +  # Prediction line
  geom_ribbon(aes(ymin = conf.low, ymax = conf.high, fill = water_treatment), alpha = 0.3) +  
  
  # theme
  theme_classic() +
  
 
  facet_wrap(~ species_name, scales = "free_x") +
  
  # water treatment 
  scale_color_manual(values = c("Well watered" = "#1f78b4", "Drought stressed" = "#e31a1c")) +
  scale_fill_manual(values = c("Well watered" = "#1f78b4", "Drought stressed" = "#e31a1c")) +
  
  # add axis titles
  labs(x = "Species Name",
       y = "Total Biomass (g)",
       title = "Model Predictions and Underlying Data",
       subtitle = "Colored by Water Treatment")

print(p)
```

1d.

Model predictions and confidence intervals for the biomass (g) of different plant species under two treatments. The drought-stressed treatment is shown in red and the well-watered treatment is blue, and shading around solid lines depicts 95% confidence intervals. The plots are separated by plant species name to compare their differences in biomass. Data source \[<https://doi.org/10.5061/dryad.v0861f7>\]

1e.

```{r}
summary(model4)
```

Based on the model selection table, model 4 has the lowest AICc value(-156.2), so it has a good balance between being descriptive and complex. Alive with having a delta of 0.00, this model has the best fit in comparison to the others; it best describes the relationship between the predictors and biomass. Between water treatments, the well-watered treatments have a higher avg. biomass than drought-stressed treatments, for all of the species. By making a visual comparison, a species like Penstemon centranthifolius(coeff. 0.05003) has a lower average biomass than other species for both treatments, while a species like Grindelia camporum(coefficient 0.31335)  has a higher average biomass for both treatments(compared to the other species). 

According to the output from this analysis, the coefficient for the well-watered treatment in 0.11695, and has a standard error of 0.01733; it also has a t-value of 6.746. This indicates that plants in well-watered conditions have about 0.11695 grams of biomass higher than the plants in drought-stressed treatments. The p-value (p \< 0.001) means that there’s a statistically significant difference.

Problem 2

2a.

My data was taken to measure my sleep every night, along with its quality, stress levels, and dreams. An affective visualiization for my personal data could look like an abstract work with different colors signifying the absence or presence of any of these variables, with different sizes or lengths of shapes to signify the number of hours slept per night. The colors are meant to draw emotion, while the patterns can be intriguing while still relaying a message.

2b.

2c.

2d.

My data is on nightly sleep from April 19th to June 1st: it includes the date that the entry was taken, the hours of sleep I got each night, how my quality of sleep was (poor, good, great), if I was stressed (yes, no), and if I dreamt (yes, no). I took inspiration from Lorraine Woodruff’s warming strips quilt and used my quality of sleep in different colors, orange for poor sleep, yellow for good sleep, and green for great sleep. I was intrigued by the idea of using colors to create a sort of mural, and I wanted to use that and add some texture to my own artwork. I decided on digital art, creating both the sketch and final artwork on an iPad. The lengths of each entry signify the hours I slept each night, and each rectangle’s pattern signifies the absence or presence of stress and dreams. No pattern meant I did not have any stress or dreams, lines indicated only stress, a cross-hatched diamond pattern indicated only dreams, and a swirled pattern indicated that both stress and dreams were present. I created this by measuring out the lengths of each entry based on my hours of sleep, and then color-coding them. To finish, I added textures to signify stress and dreams, and cleaned up the piece.

Problem 3.

3a.

The authors used Analysis of Variance (ANOVA) tests to address their main research question. Their question regards the trophic diversity of prey and biogeographical feeding patterns of the European wildcat. One of the ANOVA tests (figure 6) was used to determine the consumption of small rodents, in the presence or absence of rabbits in Mediterranean and non-Mediterranean areas.

#comment : in homework 2, I submitted table 4, but got a comment that a visualization would be better for a statistical critique, so I am adding figure 6 beneath it; figure 6 visualizes the data from table 4.

![](images/Screenshot 2024-06-02 at 5.30.26 PM-01.png)

3b.

Figure 6 of this paper visually displays their statistics in a clear and logical way. The x-axis represents two categories: the presence or absence of rabbits. The y-axis represents “small rodents consumption” in RF, or relative frequency. This shows how much of the wildcats’ diet consists of small rodents, addressing the part of the research question on the trophic diversity of their prey. It shows summary statistics in the form of means for RF, and error bars to demonstrate the data’s reliability and variability. This figure does not show underlying data or have model predictions.

In the paper’s other figures, the x-and-y-axes are in logical positions and the figures show summary statistics. For example, figures 4a and 4b of this paper have P-values, r\^2 values, and F-statistics, some included in the figures and the rest in their captions. Figures 2a/b and 4a/b from the paper also have regression lines, which are model predictions. Most of the figures have model predictors and summary statistics, and some show underlying data.

3c.

The figures have a logical structure and are clear/easy to follow and understand. However, they don’t use any different colors, instead they use different line textures. Colors are easier to differentiate for most people, as even differences in these lines are hard to see unless closely inspected. However, the figures with regression lines and summary statistics are well-placed so they’re clear and easy to read. The legends are also placed well, and there isn’t any distracting/ unnecessary information on the figures. There’s a high data-to-ink ratio, which means the ink is representative of only the essential data; there isn’t anything distracting/unnecessary on the figures. All of the figures have low visual clutter and a good data:ink ratio, making them all clear and concise.

3d.

To improve figure 6, adding underlying data/ individual data points, especially to better visualize the mean and standard error bars, would be helpful. Adding a different transparency to the underlying data would also keep the focus on the figure’s main components, while still supplying viewers with extra information. This will make any outliers visible, and give a better picture of the data spread. The data for non-Mediterranean and Mediterranean climates is the same color with solid and dotted lines; instead of a texture difference, a color difference would be helpful, especially as the dotted line is thin and looks solid from afar.
